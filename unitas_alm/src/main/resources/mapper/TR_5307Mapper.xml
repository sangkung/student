<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.app.almweb.mapper.TR_5307Mapper">

    <!-- 시나리오 코드 조회 -->
    <select id="selectSimuNo" parameterType="java.util.Map" resultType="java.util.LinkedHashMap">
SELECT ORG_CLAS_C                    AS ORG_CLAS_C
     , BR_C                          AS BR_C
     , AC_BUSI_TC                    AS AC_BUSI_TC
     , SIMU_NO                       AS SIMU_NO
     , '('||SIMU_NO||') '||SIMU_NM   AS SIMU_NM
  FROM TSI_USER_SIMU_MNG
 GROUP BY ORG_CLAS_C
        , BR_C
        , AC_BUSI_TC
        , SIMU_NO
        , SIMU_NM
 ORDER BY ORG_CLAS_C
        , BR_C
        , AC_BUSI_TC
        , SIMU_NO
    </select>


    <select id="selectTr5307List" parameterType="java.util.Map" resultType="java.util.LinkedHashMap">
WITH TEMP AS (
               SELECT ORG_CLAS_C                                                        AS ORG_CLAS_C
                    , ACCT_C                                                            AS ACCT_C          /*계정코드              */
                    , AC_BUSI_TC                                                        AS AC_BUSI_TC      /*회계사업구분코드      */
                    , CASE WHEN RATE_SSTV_YN = 'N' THEN '비금리부' ELSE '금리부' END    AS RATE_SSTV_NM    /*금리민감여부          */
                    , SUM(AMT_1)                                                        AS AMT_1           /*정형작업(A) (현행유지)*/
					, SUM(AMT_2)                                                        AS AMT_2           /*비교1(B)              */
					, SUM(AMT_3)                                                        AS AMT_3           /*비교2(C)              */
                      <if test="DIMENSION1 != null and DIMENSION1 != ''">
                    , DIMENSION1
                      </if>
                      <if test="DIMENSION2 != null and DIMENSION2 != ''">
                    , DIMENSION2
                      </if>
                 FROM (
				           /*---------------------------------------------------*/
						   /* 정형작업(A) (현행유지)                            */
						   /*---------------------------------------------------*/
                           SELECT ORG_CLAS_C                 AS ORG_CLAS_C
                                , ACCT_C                     AS ACCT_C                /*계정코드*/
                                  <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                , AC_BUSI_TC                 AS AC_BUSI_TC            /*회계사업구분코드*/
                                  </if>
                                  <if test="AC_BUSI_TC == '0000'">
                                , '1105'                     AS AC_BUSI_TC            /*전체 합산, 계정마스터와 조인용*/
                                  </if>
                                , RATE_SSTV_YN               AS RATE_SSTV_YN          /*금리민감여부*/
                                , SUM(NPV_SUM_AMT )          AS AMT_1                 /*NPV합계금액 */
								, NULL                       AS AMT_2                 /*비교1       */
								, NULL                       AS AMT_3                 /*비교2       */
                                  <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                , A.${DIMENSION1}            AS DIMENSION1
                                  </if>
                                  <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                , A.${DIMENSION2}            AS DIMENSION2
                                  </if>
                             FROM TRT_NPV_RSLT_TOT  A     /*보고서_NPV결과집계*/
                            WHERE A.BASE_DATE         = TO_CHAR(LAST_DAY(TO_DATE(#{BASE_DATE}, 'YYYYMMDD')), 'YYYYMMDD') /*기준년월*/
                              AND A.ORG_CLAS_C        = #{ORG_CLAS_C}                     /*기관분류코드*/
                              <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                              AND A.AC_BUSI_TC        = #{AC_BUSI_TC}                     /*회계사업구분코드*/
                              </if>
                              <if test="FUTU_POT_SECT_CNT != null and FUTU_POT_SECT_CNT != ''">
                              AND A.FUTU_POT_SECT_CNT = TO_NUMBER( #{FUTU_POT_SECT_CNT} ) /*미래시점구간수    */
                              </if>
                              AND A.NEW_CAP_QTY_TC    = #{NEW_CAP_QTY_TC}                 /*신규자금량구분코드*/
                              AND A.CAP_QTY_SNRO_NO   = '1'                               /*자금량시나리오번호*/
                              AND A.RATE_SNRO_NO      = '1'                               /*금리시나리오번호  */
                              AND A.ASTS_SDTP_CLAS_C  = '10'                              /*자산건전성분류코드*/                           
							<if test='BR_C == "ALL"'>
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BR_TC = '03') /*전체조합*/
							</if>
							<if test="BR_C != 'ALL'">
								<if test="BR_C == '001'">
								AND BR_C = '001' /*중앙회*/
								</if>
								<if test="BR_C != '001' and (BLNG_HQ_BR_C == '' or BLNG_HQ_BR_C == null)">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BLNG_HQ_BR_C = #{BR_C}) /*도지회별합산*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'Y'.toString()">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE MO_BR_C = #{BR_C}) /*단위조합별조회(지소포함)*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'N'.toString()">
								AND BR_C = #{BR_C}
								</if>
							</if>
                            GROUP BY A.ORG_CLAS_C
                                   , A.ACCT_C             /*계정코드*/
                                     <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                   , A.AC_BUSI_TC         /*회계사업구분코드*/
                                     </if>
                                   , A.RATE_SSTV_YN       /*금리민감여부*/
                                     <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                   , A.${DIMENSION1}
                                     </if>
                                     <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                   , A.${DIMENSION2}
                                     </if>
				           /*---------------------------------------------------*/
						   /* 비교 시뮬레이션1(B)                               */
						   /*---------------------------------------------------*/
						    UNION ALL
                           SELECT ORG_CLAS_C                 AS ORG_CLAS_C
                                , ACCT_C                     AS ACCT_C                /*계정코드*/
                                  <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                , AC_BUSI_TC                 AS AC_BUSI_TC            /*회계사업구분코드*/
                                  </if>
                                  <if test="AC_BUSI_TC == '0000'">
                                , '1105'                     AS AC_BUSI_TC            /*전체 합산, 계정마스터와 조인용*/
                                  </if>
                                , RATE_SSTV_YN               AS RATE_SSTV_YN          /*금리민감여부*/
								, NULL                       AS AMT_1                 /*NPV합계금액 */
								, SUM(NPV_SUM_AMT)           AS AMT_2                 /*비교1       */
								, NULL                       AS AMT_3                 /*비교2       */
                                  <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                , A.${DIMENSION1}            AS DIMENSION1
                                  </if>
                                  <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                , A.${DIMENSION2}            AS DIMENSION2
                                  </if>
                             FROM TSI_DRTN_GAP_TOT   A   /*시뮬레이션_듀레이션갭집계*/
                            WHERE A.BASE_DATE         = TO_CHAR(LAST_DAY(TO_DATE(#{BASE_DATE}, 'YYYYMMDD')), 'YYYYMMDD') /*기준년월*/
                              AND A.ORG_CLAS_C        = #{ORG_CLAS_C}                     /*기관분류코드*/
                              <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                              AND A.AC_BUSI_TC        = #{AC_BUSI_TC}                     /*회계사업구분코드*/
                              </if>
                              <if test="FUTU_POT_SECT_CNT != null and FUTU_POT_SECT_CNT != ''">
                              AND A.FUTU_POT_SECT_CNT = TO_NUMBER( #{FUTU_POT_SECT_CNT} ) /*미래시점구간수*/
                              </if>
                              AND A.NEW_CAP_QTY_TC    = #{NEW_CAP_QTY_TC}                 /*신규자금량구분코드*/
							  AND A.SIMU_NO           = #{SIMU_NO1}                       /*시뮬레이션번호    */
							<if test='BR_C == "ALL"'>
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BR_TC = '03') /*전체조합*/
							</if>
							<if test="BR_C != 'ALL'">
								<if test="BR_C == '001'">
								AND BR_C = '001' /*중앙회*/
								</if>
								<if test="BR_C != '001' and (BLNG_HQ_BR_C == '' or BLNG_HQ_BR_C == null)">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BLNG_HQ_BR_C = #{BR_C}) /*도지회별합산*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'Y'.toString()">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE MO_BR_C = #{BR_C}) /*단위조합별조회(지소포함)*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'N'.toString()">
								AND BR_C = #{BR_C}
								</if>
							</if>
                            GROUP BY A.ORG_CLAS_C
                                   , A.ACCT_C             /*계정코드*/
                                     <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                   , A.AC_BUSI_TC         /*회계사업구분코드*/
                                     </if>
                                   , A.RATE_SSTV_YN       /*금리민감여부*/
                                     <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                   , A.${DIMENSION1}
                                     </if>
                                     <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                   , A.${DIMENSION2}
                                     </if>
				           /*---------------------------------------------------*/
						   /* 비교 시뮬레이션2(C)                               */
						   /*---------------------------------------------------*/
						    UNION ALL
                           SELECT ORG_CLAS_C                 AS ORG_CLAS_C
                                , ACCT_C                     AS ACCT_C                /*계정코드*/
                                  <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                , AC_BUSI_TC                 AS AC_BUSI_TC            /*회계사업구분코드*/
                                  </if>
                                  <if test="AC_BUSI_TC == '0000'">
                                , '1105'                     AS AC_BUSI_TC            /*전체 합산, 계정마스터와 조인용*/
                                  </if>
                                , RATE_SSTV_YN               AS RATE_SSTV_YN          /*금리민감여부*/
								, NULL                       AS AMT_1                 /*NPV합계금액 */
								, NULL                       AS AMT_2                 /*비교1       */
                                , SUM(NPV_SUM_AMT)           AS AMT_3                 /*비교2       */
                                  <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                , A.${DIMENSION1}            AS DIMENSION1
                                  </if>
                                  <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                , A.${DIMENSION2}            AS DIMENSION2
                                  </if>
                             FROM TSI_DRTN_GAP_TOT   A   /*시뮬레이션_듀레이션갭집계*/
                            WHERE A.BASE_DATE         = TO_CHAR(LAST_DAY(TO_DATE(#{BASE_DATE}, 'YYYYMMDD')), 'YYYYMMDD') /*기준년월*/
                              AND A.ORG_CLAS_C        = #{ORG_CLAS_C}                     /*기관분류코드*/
                              <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                              AND A.AC_BUSI_TC        = #{AC_BUSI_TC}                     /*회계사업구분코드*/
                              </if>
                              <if test="FUTU_POT_SECT_CNT != null and FUTU_POT_SECT_CNT != ''">
                              AND A.FUTU_POT_SECT_CNT = TO_NUMBER( #{FUTU_POT_SECT_CNT} ) /*미래시점구간수*/
                              </if>
                              AND A.NEW_CAP_QTY_TC    = #{NEW_CAP_QTY_TC}                 /*신규자금량구분코드*/
							  AND A.SIMU_NO           = #{SIMU_NO2}                       /*시뮬레이션번호    */
							<if test='BR_C == "ALL"'>
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BR_TC = '03') /*전체조합*/
							</if>
							<if test="BR_C != 'ALL'">
								<if test="BR_C == '001'">
								AND BR_C = '001' /*중앙회*/
								</if>
								<if test="BR_C != '001' and (BLNG_HQ_BR_C == '' or BLNG_HQ_BR_C == null)">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE BLNG_HQ_BR_C = #{BR_C}) /*도지회별합산*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'Y'.toString()">
								AND BR_C IN (SELECT BR_C FROM TTL_BR_C_INFO WHERE MO_BR_C = #{BR_C}) /*단위조합별조회(지소포함)*/
								</if>
								<if test="BR_C != '001' and BLNG_HQ_BR_C != '' and BLNG_HQ_BR_C != null and SUB_YN == 'N'.toString()">
								AND BR_C = #{BR_C}
								</if>
							</if>
                            GROUP BY A.ORG_CLAS_C
                                   , A.ACCT_C             /*계정코드*/
                                     <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                                   , A.AC_BUSI_TC         /*회계사업구분코드*/
                                     </if>
                                   , A.RATE_SSTV_YN       /*금리민감여부*/
                                     <if test="DIMENSION1 != null and DIMENSION1 != ''">
                                   , A.${DIMENSION1}
                                     </if>
                                     <if test="DIMENSION2 != null and DIMENSION2 != ''">
                                   , A.${DIMENSION2}
                                     </if>
						   
                      )
             GROUP BY ORG_CLAS_C
                    , ACCT_C              /*계정코드*/
                    , AC_BUSI_TC          /*회계사업구분코드*/
                    , RATE_SSTV_YN        /*금리민감여부*/
                      <if test="DIMENSION1 != null and DIMENSION1 != ''">
                    , DIMENSION1
                      </if>
                      <if test="DIMENSION2 != null and DIMENSION2 != ''">
                    , DIMENSION2
                      </if>
        )
       SELECT LVL1                                                                                                                AS L1_NM
              <if test="LEVEL == 1">
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , DECODE(GROUPING_ID(RATE_SSTV_NM), 1, LVL1||' 합계', RATE_SSTV_NM)                                                   AS RATE_SSTV_NM
            , GROUPING_ID (RATE_SSTV_NM, DIMENSION1)                                                                              AS GRP_ID
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1), 1, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), DIMENSION1)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1), 1, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), DIMENSION1)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1), 1, RATE_SSTV_NM||LVL1||' 합계',    DIMENSION1)
              END                                                                                                                 AS DIMENSION1
            , NULL                                                                                                                AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , DECODE(GROUPING_ID(RATE_SSTV_NM), 1, LVL1||' 합계', RATE_SSTV_NM)                                                    AS RATE_SSTV_NM
            , GROUPING_ID (RATE_SSTV_NM, DIMENSION1, DIMENSION2)                                                                   AS GRP_ID
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1, DIMENSION2), 3, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), DIMENSION1)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1, DIMENSION2), 3, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), DIMENSION1)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, DIMENSION1, DIMENSION2), 3, RATE_SSTV_NM||LVL1||' 합계',    DIMENSION1)
              END                                                                                                                  AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2)                       AS DIMENSION2
                      </when>
                      <otherwise>
            , CASE WHEN LVL1 = '자산' AND RATE_SSTV_NM='금리부'  THEN DECODE(GROUPING_ID(RATE_SSTV_NM), 0, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), RATE_SSTV_NM||' 합계')
                   WHEN LVL1 = '부채' AND RATE_SSTV_NM='금리부'  THEN DECODE(GROUPING_ID(RATE_SSTV_NM), 0, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), RATE_SSTV_NM||' 합계')
                   ELSE                                               DECODE(GROUPING_ID(RATE_SSTV_NM), 1, RATE_SSTV_NM||LVL1||' 합계',    RATE_SSTV_NM||' 합계')
              END                                                                                                                   AS RATE_SSTV_NM
            , GROUPING_ID (RATE_SSTV_NM)                                                                                            AS GRP_ID
            , NULL                                                                                                                  AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 2">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2), 3, LVL1||' 합계', RATE_SSTV_NM)                                               AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2), 1, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2), 1, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2), 1, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                                   AS L2_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, DIMENSION1)                                                                          AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, DIMENSION1), 1, LVL2||' 소계', DIMENSION1)                                    AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, DIMENSION1, DIMENSION2)                                                              AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, DIMENSION1, DIMENSION2), 3, LVL2||' 소계', DIMENSION1)                        AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2)                  AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2)                                                                                      AS GRP_ID
            , NULL                                                                                                                  AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 3">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3), 7, LVL1||' 합계', RATE_SSTV_NM)                                         AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3), 3, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3), 3, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3), 3, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                                   AS L2_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3), 1, LVL2||' 소계', LVL3)                                                 AS L3_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, DIMENSION1)                                                                    AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, DIMENSION1), 1, LVL3||' 소계', DIMENSION1)                              AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, DIMENSION1, DIMENSION2)                                                        AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, DIMENSION1, DIMENSION2), 3, LVL3||' 소계', DIMENSION1)                  AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2)            AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3)                                                                                AS GRP_ID
            , NULL                                                                                                                  AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 4">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 15, LVL1||' 합계', RATE_SSTV_NM)                                  AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 7, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 7, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 7, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                                   AS L2_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 3, LVL2||' 소계', LVL3)                                           AS L3_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4), 1, LVL3||' 소계', LVL4)                                           AS L4_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1)                                                              AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1), 1, LVL4||' 소계', DIMENSION1)                        AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1, DIMENSION2)                                                  AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1, DIMENSION2), 3, LVL4||' 소계', DIMENSION1)            AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2)      AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4)                                                                          AS GRP_ID
            , NULL                                                                                                                  AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 5">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 31, LVL1||' 합계', RATE_SSTV_NM)                            AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 15, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 15, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 15, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                                   AS L2_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 7,  LVL2||' 소계', LVL3)                                    AS L3_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 3,  LVL3||' 소계', LVL4)                                    AS L4_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5), 1,  LVL4||' 소계', LVL5)                                    AS L5_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1)                                                        AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1), 1, LVL5||' 소계', DIMENSION1)                  AS DIMENSION1
            , NULL                                                                                                                  AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1, DIMENSION2)                                             AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1, DIMENSION2), 3, LVL5||' 소계', DIMENSION1)       AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2) AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5)                                                                     AS GRP_ID
            , NULL                                                                                                                   AS DIMENSION1
            , NULL                                                                                                                   AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 6">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 63, LVL1||' 합계', RATE_SSTV_NM)                       AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 31, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 31, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 31, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                                    AS L2_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 15, LVL2||' 소계', LVL3)                               AS L3_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 7,  LVL3||' 소계', LVL4)                               AS L4_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 3,  LVL4||' 소계', LVL5)                               AS L5_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6), 1,  LVL5||' 소계', LVL6)                               AS L6_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1)                                                   AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1), 1, LVL6||' 소계', DIMENSION1)             AS DIMENSION1
            , NULL                                                                                                                   AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1, DIMENSION2)                                             AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1, DIMENSION2), 3, LVL6||' 소계', DIMENSION1)       AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2) AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6)                                                               AS GRP_ID
            , NULL                                                                                                                   AS DIMENSION1
            , NULL                                                                                                                   AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              <if test="LEVEL == 7">
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 127, LVL1||' 합계', RATE_SSTV_NM)      AS RATE_SSTV_NM
            , CASE WHEN LVL1 = '자산' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 63, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(A)', ' 합계'), LVL2)
                   WHEN LVL1 = '부채' THEN DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 63, RATE_SSTV_NM||LVL1||DECODE(RATE_SSTV_NM, '금리부', ' 합계(B)', ' 합계'), LVL2)
                   ELSE                    DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 63, RATE_SSTV_NM||LVL1||' 합계',    LVL2)
              END                                                                                                          AS L2_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 31, LVL2||' 소계', LVL3)               AS L3_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 15, LVL3||' 소계', LVL4)               AS L4_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 7,  LVL4||' 소계', LVL5)               AS L5_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 3,  LVL5||' 소계', LVL6)               AS L6_NM
            , DECODE(GROUPING_ID(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7), 1,  LVL6||' 소계', LVL7)               AS L7_NM
                  <choose>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1)                                       AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1), 1, LVL7||' 소계', DIMENSION1) AS DIMENSION1
            , NULL                                                                                                             AS DIMENSION2
                      </when>
                      <when test="DIMENSION1 != '' and DIMENSION1 != null and DIMENSION2 != '' and DIMENSION2 != null">
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1, DIMENSION2)                                             AS GRP_ID
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1, DIMENSION2), 3, LVL7||' 소계', DIMENSION1)       AS DIMENSION1
            , DECODE(GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1, DIMENSION2), 1, DIMENSION1||' 소계', DIMENSION2) AS DIMENSION2
                      </when>
                      <otherwise>
            , GROUPING_ID (RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7)                                                AS GRP_ID
            , NULL                                                                                                          AS DIMENSION1
            , NULL                                                                                                          AS DIMENSION2
                      </otherwise>
                  </choose>
              </if>
              /*구간 처리*/
            , ROUND(SUM(AMT_1) / TO_NUMBER(#{AMT_UNIT}))                    AS AMT_1    /*정형작업(A)*/
            , ROUND(SUM(AMT_2) / TO_NUMBER(#{AMT_UNIT}))                    AS AMT_2    /*비교1(B)   */
            , ROUND(SUM(AMT_3) / TO_NUMBER(#{AMT_UNIT}))                    AS AMT_3    /*비교2(C)   */
            , ROUND((SUM(AMT_1) - SUM(AMT_2)) / TO_NUMBER(#{AMT_UNIT}))     AS AMT_4    /* A-B       */
            , CASE WHEN SUM(AMT_1) != 0
                   THEN ROUND((SUM(AMT_1) - SUM(AMT_2)) / SUM(AMT_1) * 100, 2)||'%'
                   ELSE '0%'
              END                                                           AS AMT_5    /* A-B/A     */
            , ROUND((SUM(AMT_1) - SUM(AMT_3)) / TO_NUMBER(#{AMT_UNIT}))     AS AMT_6    /* A-C       */
            , CASE WHEN SUM(AMT_1) != 0
                   THEN ROUND((SUM(AMT_1) - SUM(AMT_3)) / SUM(AMT_1) * 100, 2) ||'%'
                   ELSE '0%'
              END                                                           AS AMT_7    /* A-C/A     */
        FROM (
               SELECT B.LVL1
                    , A.RATE_SSTV_NM
                    , B.LVL2
                    , B.LVL3
                    , B.LVL4
                    , B.LVL5
                    , B.LVL6
                    , B.LVL7
                    , B.ACCT_C_NM
                    , NVL(A.AMT_1, 0) AS AMT_1   /*현행유지(A)*/
                    , NVL(A.AMT_2, 0) AS AMT_2   /*비교1(B)   */
                    , NVL(A.AMT_3, 0) AS AMT_3   /*비교2(C)   */
                    , B.PRNT_ORD1
                    , B.PRNT_ORD2
                    , B.PRNT_ORD3
                    , B.PRNT_ORD4
                    , B.PRNT_ORD5
                    , B.PRNT_ORD6
                    , B.PRNT_ORD7
                      <if test="DIMENSION1 != null and DIMENSION1 != ''">
                    , A.DIMENSION1               AS PRNT_ORD8
                    , NVL(B1.DIMS_CDNM, '-')     AS DIMENSION1
                      </if>
                      <if test="DIMENSION2 != null and DIMENSION2 != ''">
                    , A.DIMENSION2               AS PRNT_ORD9
                    , NVL(B2.DIMS_CDNM, '-')     AS DIMENSION2
                      </if>
                FROM TEMP A
                   , (
                        SELECT LEVEL
                             , BASE_DATE
                             , SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%') AS ACCT_PATH
                             , REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 1 ) AS LVL1
                             , REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 2 ) AS LVL2
                             , REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 3 ) AS LVL3
                             , NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 4 ),TRIM(ACCT_C_NM))  AS LVL4
                             , NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 5 ),TRIM(ACCT_C_NM))  AS LVL5
                             , NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 6 ),TRIM(ACCT_C_NM))  AS LVL6
                             , NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(ACCT_C_NM), '%'),'[^%]+' , 1 , 7 ),TRIM(ACCT_C_NM))  AS LVL7
                             , TRIM(ACCT_C_NM) AS ACCT_C_NM
                             , ORG_CLAS_C
                             , AC_BUSI_TC
                             , ACCT_C
                             , TO_NUMBER(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 1 )                    )  AS PRNT_ORD1
                             , TO_NUMBER(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 2 )                    )  AS PRNT_ORD2
                             , TO_NUMBER(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 3 )                    )  AS PRNT_ORD3
                             , TO_NUMBER(NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 4 ),TRIM(PRNT_ORD)))  AS PRNT_ORD4
                             , TO_NUMBER(NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 5 ),TRIM(PRNT_ORD)))  AS PRNT_ORD5
                             , TO_NUMBER(NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 6 ),TRIM(PRNT_ORD)))  AS PRNT_ORD6
                             , TO_NUMBER(NVL(REGEXP_SUBSTR(SYS_CONNECT_BY_PATH(TRIM(PRNT_ORD), '%'),'[^%]+' , 1 , 7 ),TRIM(PRNT_ORD)))  AS PRNT_ORD7
                          FROM TSY_ACCT_MSTR_MNG
                         WHERE BASE_DATE  = (SELECT MAX(BASE_DATE) FROM TSY_ACCT_MSTR_MNG WHERE BASE_DATE &lt;= TO_CHAR(LAST_DAY(TO_DATE(#{BASE_DATE}, 'YYYYMMDD')), 'YYYYMMDD'))
                           AND USE_YN     = 'Y'
                           AND ORG_CLAS_C = #{ORG_CLAS_C}
                           <if test="AC_BUSI_TC != null and AC_BUSI_TC != '' and AC_BUSI_TC != '0000'">
                           AND AC_BUSI_TC = #{AC_BUSI_TC}
                           </if>
                           <if test="AC_BUSI_TC == '0000'">
                           AND AC_BUSI_TC = '1105'
                           </if>
                         START WITH UP_ACCT_C  = '0000000'
                       CONNECT BY PRIOR ACCT_C = UP_ACCT_C AND PRIOR BASE_DATE = BASE_DATE AND PRIOR ORG_CLAS_C = ORG_CLAS_C AND PRIOR AC_BUSI_TC = AC_BUSI_TC
                     ) B
                     <if test="DIMENSION1 != null and DIMENSION1 != ''">
                   , TSY_DIMS_ITEM_MNG B1
                     </if>
                     <if test="DIMENSION2 != null and DIMENSION2 != ''">
                   , TSY_DIMS_ITEM_MNG B2
                     </if>
               WHERE B.ACCT_C     = A.ACCT_C
                 AND B.AC_BUSI_TC = A.AC_BUSI_TC
                 AND B.ORG_CLAS_C = A.ORG_CLAS_C
                 <if test="DIMENSION1_NUM != null and DIMENSION1_NUM != ''">
                 AND B1.DIMS_ITEM_NO(+)  = TO_NUMBER(#{DIMENSION1_NUM})
                 AND B1.DIMS_C_VAL(+)    = A.DIMENSION1
                 </if>
                 <if test="DIMENSION2_NUM != null and DIMENSION2_NUM != ''">
                 AND B2.DIMS_ITEM_NO(+)  = TO_NUMBER(#{DIMENSION2_NUM})
                 AND B2.DIMS_C_VAL(+)    = A.DIMENSION2
                 </if>
              )
        GROUP BY LVL1
                 <if test="LEVEL == 1">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 2">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 3">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 4">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 5">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 6">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6)
                         </otherwise>
                     </choose>
                 </if>
                 <if test="LEVEL == 7">
                     <choose>
                         <when test="DIMENSION1 != '' and DIMENSION1 != null and (DIMENSION2 == '' or DIMENSION2 == null)">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1)
                         </when>
                         <when test="DIMENSION1 != '' and DIMENSION2 != null and DIMENSION2 != '' and DIMENSION2 != null">
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7, DIMENSION1, DIMENSION2)
                         </when>
                         <otherwise>
                             , ROLLUP(RATE_SSTV_NM, LVL2, LVL3, LVL4, LVL5, LVL6, LVL7)
                         </otherwise>
                     </choose>
                 </if>
        ORDER BY MAX(PRNT_ORD1)
               , CASE WHEN RATE_SSTV_NM LIKE '금리%'   THEN 1
                      WHEN RATE_SSTV_NM LIKE '비금리%' THEN 2
                      ELSE 3
                 END
                 <if test="LEVEL == 2">
               , MAX(PRNT_ORD2)
                 </if>
                 <if test="LEVEL == 3">
               , MAX(PRNT_ORD2)
               , MAX(PRNT_ORD3)
                 </if>
                 <if test="LEVEL == 4">
               , MAX(PRNT_ORD2)
               , MAX(PRNT_ORD3)
               , MAX(PRNT_ORD4)
                 </if>
                 <if test="LEVEL == 5">
               , MAX(PRNT_ORD2)
               , MAX(PRNT_ORD3)
               , MAX(PRNT_ORD4)
               , MAX(PRNT_ORD5)
                 </if>
                 <if test="LEVEL == 6">
               , MAX(PRNT_ORD2)
               , MAX(PRNT_ORD3)
               , MAX(PRNT_ORD4)
               , MAX(PRNT_ORD5)
               , MAX(PRNT_ORD6)
                 </if>
                 <if test="LEVEL == 7">
               , MAX(PRNT_ORD2)
               , MAX(PRNT_ORD3)
               , MAX(PRNT_ORD4)
               , MAX(PRNT_ORD5)
               , MAX(PRNT_ORD6)
               , MAX(PRNT_ORD7)
                 </if>
                 <if test="DIMENSION1 != null and DIMENSION1 != ''">
               , MAX(PRNT_ORD8)
                 </if>
                 <if test="DIMENSION2 != null and DIMENSION2 != ''">
               , MAX(PRNT_ORD9)
                 </if>
               , GRP_ID
    </select>

</mapper>